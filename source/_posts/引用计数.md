title: 引用计数
date: 2015-06-12 08:44:39
tags: [引用计数]
categories: [Swift]

---

2种导致循环引用的问题

+ 两类实例它们各自包含彼此的强应用属性
+ 闭包赋值给了属性，且闭包内使用了self。


##引用计数的情况

1. 两个属性值都允许为nil （`若引用`）
2. 一个值允许为nil，另一值不允许为nil（`无主引用`）
3. 两个值都不允许为nil（`无主引用`和`隐式解析可选属性`）

##闭包引起的循环引用

`闭包占用列表`

```
{[weak self, unowned object] ()->() in

}
```

```
{
	[weak self, unowned object] in 
		code
}
```

当闭包和捕获的实例总是互相引用时并且总是同时销毁时，闭包内的捕获定义为无主引用

相反，当捕获的实例可能会是nil时，将闭包内的捕获定义为弱引用。弱引用总是可选类型，并且当弱引用的实例被销毁后，弱引用的值会自动设置为nil。我们可以在闭包内检查它们是否存在。


